#---------Apresentação---------#

print("\nFERRAMENTAS PARA PENTEST")

#---------Modulos---------#

from scripts import portscan
from scripts import dnsbrute

#---------Seletor---------#

print("\nSelecione uma ferramenta\n")
print(" - [1] - PortScan\n")
print(" - [2] - DNS Brute Force\n")

fr = input(": ")

#---------Inicio---------#

if(fr == "1"):
	print("\n---------PORTSCAN---------\n")
	sd = input('Deseja salvar os dados de saída?[sim/nao]: ')
	target = str(input("\nAlvo: "))
	port_select = str(input("\nEscanear todas as portas ou apenas as padrões?[P/t]: "))
	if(port_select == "t" or port_select == "T"):
		ps = portscan.PORTSCAN(target, 'all', sd)
		ps.prun()
		ps.re_a()
		ps.save()
	else:
		ps = portscan.PORTSCAN(target, 'pattern', sd)
		ps.prun()
		ps.re_p()
		ps.save()
elif(fr == "2"):
	print("\n---------DNS Brute Force---------\n")
	target = str(input('Alvo: '))
	print('\n' + '-'*59 + '\n')
	wlist = input('word-list Pequena, média ou grande?[P/m/g]: ')
	print('\n' + '-'*59 + '\n')
	type_in = str(input('[A/AAAA/MX/NS/TXT]: '))
	print('\n' + '-'*59 + '\n')
	if(wlist == 'M' or wlist == 'm'):
		db = dnsbrute.DNSB(target, 'medium', type_in)
		db.run()
	elif(wlist == 'G' or wlist == 'g'):
		db = dnsbrute.DNSB(target, 'large', type_in)
		db.run()
	else:
		db = dnsbrute.DNSB(target, 'small', type_in)
		db.run()

else:
	print("\nCOMANDO NÃO RECONHECIDO\n")