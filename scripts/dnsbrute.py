import sys
import dns.resolver
import time

a = 1

class DNSB():
    def __init__(self, host, wlist, typein):
        self.host = host
        self.wlist = wlist
        self.typein = typein
    pass

    def run(self):
        
        global a

        if(self.wlist == 'P' or self.wlist == 'p'):
            try:
                arq = open('wlists/Filenames_or_Directories_Common.wordlist')
                sub = arq.read().splitlines()
            except:
                print('\033 [31m' + 'Por algum motivo, o arquivo necessário não foi encontrado. \nAssim, o DNS bruto será encerrado' + '\033 [0; 0m')
                print('\n' + '-'*59 + '\n')
                time.sleep(10)
            for i in sub:
                try:
                    target = (f'{i}.{self.host}')
                    rt = dns.resolver.resolve(target, self.typein)
                    for result in rt:
                        print('\033[32m' + 'Alvo: ' + '\033[0;0m' + '{} <----> IP: {} <====> {}'.format(target, result, self.typein))
                        print('\n' + '-'*24 + '\n')
                except:
                    a += a
                pass
        elif(self.wlist == 'M' or self.wlist == 'm'):
            try:
                arq = open('wlists/Filenames_or_Directories_Extra.wordlist')
                sub = arq.read().splitlines()
            except:
                print('\033 [31m' + 'Por algum motivo, o arquivo necessário não foi encontrado. \nAssim, o DNS bruto será encerrado' + '\033 [0; 0m')
                print('\n' + '-'*59 + '\n')
                time.sleep(10)
            for i in sub:
                try:
                    target = (f'{i}.{self.host}')
                    rs = dns.resolver.resolve(target, self.typein)
                    for result in rs:
                        print('\033[32m' + 'Alvo: ' + '\033[0;0m' + '{} <----> IP: {} <====> {}'.format(target, result, self.typein))
                        print('\n' + '-'*24 + '\n')
                except:
                    a += a
                pass
        elif(self.wlist == 'G' or self.wlist == 'g'):
            try:
                arq = open('wlists/Filenames_or_Directories_All.wordlist')
                sub = arq.read().splitlines()
            except:
                print('\033 [31m' + 'Por algum motivo, o arquivo necessário não foi encontrado. \nAssim, o DNS bruto será encerrado' + '\033 [0; 0m')
                print('\n' + '-'*59 + '\n')
                time.sleep(10)
            for i in sub:
                try:
                    target = ('{}.{}'.format(i, self.host))
                    rt = dns.resolver.resolve(target, self.typein)
                    for result in rt:
                        print('\033[32m' + 'Alvo: ' + '\033[0;0m' + '{} <----> IP: {} <====> {}'.format(target, result, self.typein))
                        print('\n' + '-'*24 + '\n')
                except:
                    a += a
                pass
        else:
            print('\033[31m' + 'Comando não reconhecido' + '\033[0;0m')
            time.sleep(10)
            sys.exit(1)
    pass