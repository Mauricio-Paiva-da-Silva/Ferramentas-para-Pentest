#---------Bibliotecas---------#

import socket

#---------Padroes---------#

port_pattern = [21, 22, 25, 53, 80, 110, 135, 136, 137, 138, 139, 143, 443, 3306, 3389, 8080]
all_port = range(65535)

#---------CLASS---------#

class PORTSCAN:
    def __init__(self, ip, port):
        self.ip = ip
        self.port = port
    pass
    
    def prun(self):

        target = self.ip
        ports = self.port

        if(ports == "pattern"):
            global port_pattern

            print("\nINICIANDO ESCANEAMENTO DAS PORTAS PADRÃ•ES\n")

            for tport in port_pattern:
                client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                client.settimeout(0.05)
                code = client.connect_ex((target, tport))
                codet = str(code)
                if(codet == '0'):
                    print('PORTA: {} <----> '.format(tport) + '\033[32m' + 'ABERTA' + '\033[0;0m\n')
                else:
                    print('PORTA: {} <----> '.format(tport) + '\033[31m' + 'FECHADA' + '\033[0;0m\n')
            print("\nESCANEAMENTO COMPLETO\n")
        else:
            global all_port

            print("\nINICIANDO ESCANEAMENTO DE TODAS AS PORTAS\n")

            for tport in all_port:
                client = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                client.settimeout(0.05)
                code = client.connect_ex((target, tport))
                codet = str(code)
                if(codet == '0'):
                    print('PORTA: {} <----> '.format(tport) + '\033[32m' + 'ABERTA' + '\033[0;0m\n')
            print("\nESCANEAMENTO COMPLETO\n")

    pass